# TwoMillion

![https://lh7-us.googleusercontent.com/yccYkKAHVyHioPzFJdM9IYH3xt-XbHIxubb1uU2r80iWJzRTTa4yj9B9OkMylRZIX2vO3fa4aTb13slXOCW-KP5tguq7UCVHJxZVYRJKhR1iooP8EZYCvIMiUiZDeQJFrz7QiWBvDioj](https://lh7-us.googleusercontent.com/yccYkKAHVyHioPzFJdM9IYH3xt-XbHIxubb1uU2r80iWJzRTTa4yj9B9OkMylRZIX2vO3fa4aTb13slXOCW-KP5tguq7UCVHJxZVYRJKhR1iooP8EZYCvIMiUiZDeQJFrz7QiWBvDioj)

truy cập 10.10.11.221:80 : trang chủ

truy cập join -> /invite và view source code

phân tích js

![https://lh7-us.googleusercontent.com/jBqarx6C00eDHU7BkINZfpjkYDohjBfYTUwT6BeDDOUpm8pk6M-YH6G4eptw5rJRiPbPmm1ChTboxxKLXZpn9oKpIM1oB8a1hQxXGzHBpPsRj3xN_qedTyE7kossJdPYApl-pGd0MN5S](https://lh7-us.googleusercontent.com/jBqarx6C00eDHU7BkINZfpjkYDohjBfYTUwT6BeDDOUpm8pk6M-YH6G4eptw5rJRiPbPmm1ChTboxxKLXZpn9oKpIM1oB8a1hQxXGzHBpPsRj3xN_qedTyE7kossJdPYApl-pGd0MN5S)

chỉ là gửi request verify code invite

truy cập file inviteapi.js thấy có thể bị obfuscated(xáo trộn)

![https://lh7-us.googleusercontent.com/TMpcrrzE1qRV0JTvZFyPmEDgIzgDwTHLgTXUN4fveKTLhLRo82ViYdYvLcOss9LjtBHwAQ74ikuBoVLMLSvqYd6wS9v9Ua0ERTKqj_5x0WLk6jgEPNE165UfywWjKBQRGBR67Qr2s5Bn](https://lh7-us.googleusercontent.com/TMpcrrzE1qRV0JTvZFyPmEDgIzgDwTHLgTXUN4fveKTLhLRo82ViYdYvLcOss9LjtBHwAQ74ikuBoVLMLSvqYd6wS9v9Ua0ERTKqj_5x0WLk6jgEPNE165UfywWjKBQRGBR67Qr2s5Bn)

dùng [de4js - JavaScript Deobfuscator (kshift.me)](https://de4js.kshift.me/) deobfuscate js được

![https://lh7-us.googleusercontent.com/wLgU3et5ciyVJ_8WpoHzL4EhnaLSMrvDqSiVq5Z4eU-b0IeiOyzQDAIfcPF1iUXXVWYCsbwfc_yFXV00DMDpIvK_rduybixc81fn97bciO9QuhDlmFdBrsKzCj0XpQno3-3zqrP11L8D](https://lh7-us.googleusercontent.com/wLgU3et5ciyVJ_8WpoHzL4EhnaLSMrvDqSiVq5Z4eU-b0IeiOyzQDAIfcPF1iUXXVWYCsbwfc_yFXV00DMDpIvK_rduybixc81fn97bciO9QuhDlmFdBrsKzCj0XpQno3-3zqrP11L8D)

hàm đầu giống ở script /invite, dùng để xác thực code nhập vào

![https://lh7-us.googleusercontent.com/OmPe-IU2q1ct4X2R3VfKNz85JICqIws-RYx31Id9HI1tc3aeGJtbwbEApJD7NyCb9AhyANDHXjNY6TjKI0NQO9BAVDM1jc9RXIqYYJYSFit9HdCTEihK5A6fXfWAMLOtf2eo18DyVRa6](https://lh7-us.googleusercontent.com/OmPe-IU2q1ct4X2R3VfKNz85JICqIws-RYx31Id9HI1tc3aeGJtbwbEApJD7NyCb9AhyANDHXjNY6TjKI0NQO9BAVDM1jc9RXIqYYJYSFit9HdCTEihK5A6fXfWAMLOtf2eo18DyVRa6)

hàm 2 interesting

![https://lh7-us.googleusercontent.com/MkVfYQecAHx2gyzTux1bgiOKs2wIAjOmbWMeW4lgo72cugIcJIDtde6V1OvPX-9XeN63Z6rtUjVECtfgeibRuleUhocq_9OGsXltMIJjZ5XaVT2Ih_WYT3HLN01K2rAUoqQQ2QybXDIV](https://lh7-us.googleusercontent.com/MkVfYQecAHx2gyzTux1bgiOKs2wIAjOmbWMeW4lgo72cugIcJIDtde6V1OvPX-9XeN63Z6rtUjVECtfgeibRuleUhocq_9OGsXltMIJjZ5XaVT2Ih_WYT3HLN01K2rAUoqQQ2QybXDIV)

![https://lh7-us.googleusercontent.com/MM30VbtIFVRqJpBIlEdkL-M5l-Oj196lJ1PsWIWTwAokB9N4aJVeOQd9rkYNWX8u60eAZML0WwG7umpXGT7ixbl-94vPJFXWFgoV530FImKPVEsW4YlavuKyjhMYV-4RSUCUj9U7RbKg](https://lh7-us.googleusercontent.com/MM30VbtIFVRqJpBIlEdkL-M5l-Oj196lJ1PsWIWTwAokB9N4aJVeOQd9rkYNWX8u60eAZML0WwG7umpXGT7ixbl-94vPJFXWFgoV530FImKPVEsW4YlavuKyjhMYV-4RSUCUj9U7RbKg)

decrypt rot13 data : In order to generate the invite code, make a POST request to /api/v1/invite/generate

có thông tin gì đó đc encode

![https://lh7-us.googleusercontent.com/VBYQvp0WflhSlg55JT9H2uaYwvDOp15Sj-8aVmcLuVn4KcqxL54k5iAHcLFebg7UOisOZU-y_rkqXBp5ovc0eaTpp9-zWWc8Spjk7X0DnFlrnvQWGn6L0thM4ZaxSHpjvgL9E6GRgpwo](https://lh7-us.googleusercontent.com/VBYQvp0WflhSlg55JT9H2uaYwvDOp15Sj-8aVmcLuVn4KcqxL54k5iAHcLFebg7UOisOZU-y_rkqXBp5ovc0eaTpp9-zWWc8Spjk7X0DnFlrnvQWGn6L0thM4ZaxSHpjvgL9E6GRgpwo)

![https://lh7-us.googleusercontent.com/BHQpNUVdhuP_5WL4dYXh1eeNxgaxGlheOcliA31GLtodmAFX58nhbNMJxVRno_k7-fUrosp2FyMkGGoGQ9G0F0ydnSgQxo6ALmBxod3QloPJxPDcY78s6UvEy57aH-NbxHH_vCQ9jW8j](https://lh7-us.googleusercontent.com/BHQpNUVdhuP_5WL4dYXh1eeNxgaxGlheOcliA31GLtodmAFX58nhbNMJxVRno_k7-fUrosp2FyMkGGoGQ9G0F0ydnSgQxo6ALmBxod3QloPJxPDcY78s6UvEy57aH-NbxHH_vCQ9jW8j)

decode

![https://lh7-us.googleusercontent.com/kapJpGSaFMJwjabcJXSM0wjxxMe_6t_UUL99KyP2csNI1MJFaTmNglhgZPaFTKKvsMKmMW8ATWfxx1N_zVKBRfWOmxINpCgatkMypn6ZxF9hJJR6jq8s1d96pA-XfXRyVT88rVdS0IZD](https://lh7-us.googleusercontent.com/kapJpGSaFMJwjabcJXSM0wjxxMe_6t_UUL99KyP2csNI1MJFaTmNglhgZPaFTKKvsMKmMW8ATWfxx1N_zVKBRfWOmxINpCgatkMypn6ZxF9hJJR6jq8s1d96pA-XfXRyVT88rVdS0IZD)

invite code: N6DQD-3PCQT-TR3RV-KKF82

![https://lh7-us.googleusercontent.com/pL_zI36gy9M5XsLKyVp1hars-O4kvV0VRSbaqaYmPSIFizKLYCc6ODJxpgGU9YdU16s7EHGjyBcrSTF1oY-hrVKtr0gQaSMjIF2osew_NKVdfwvDvbZRHc8e8Htk8R0Aiu80pKdn9X_f](https://lh7-us.googleusercontent.com/pL_zI36gy9M5XsLKyVp1hars-O4kvV0VRSbaqaYmPSIFizKLYCc6ODJxpgGU9YdU16s7EHGjyBcrSTF1oY-hrVKtr0gQaSMjIF2osew_NKVdfwvDvbZRHc8e8Htk8R0Aiu80pKdn9X_f)

![https://lh7-us.googleusercontent.com/Rv6pjbRcKvbj9xapQqS7qr5ELGn9UoffkxrjbDEE2J_Glgq4HqpcyaqFw9Q1vkYajBpfZTK8oHpeoR6lv1ArKjju2dlbf-GDxRuVOGRmRiXNCFvYEtvnOMxDmuC1FHfXOoDrgWX-HbCL](https://lh7-us.googleusercontent.com/Rv6pjbRcKvbj9xapQqS7qr5ELGn9UoffkxrjbDEE2J_Glgq4HqpcyaqFw9Q1vkYajBpfZTK8oHpeoR6lv1ArKjju2dlbf-GDxRuVOGRmRiXNCFvYEtvnOMxDmuC1FHfXOoDrgWX-HbCL)

![https://lh7-us.googleusercontent.com/XXlZhpy8uIr8K_3QleLh6Aly6Oo6fcGnZ1sNYRCWn_9Jf0-aYWzsQVuXxpRZdz0zghEekTwPscBvUI7X8yf5y3y6zTN3gJtubz4aKcVRRVKiPeyjIF1xnkugKK3UJLlAFE41RSfyLMSK](https://lh7-us.googleusercontent.com/XXlZhpy8uIr8K_3QleLh6Aly6Oo6fcGnZ1sNYRCWn_9Jf0-aYWzsQVuXxpRZdz0zghEekTwPscBvUI7X8yf5y3y6zTN3gJtubz4aKcVRRVKiPeyjIF1xnkugKK3UJLlAFE41RSfyLMSK)

truy cập được /home

![https://lh7-us.googleusercontent.com/6d3sWP48n91qiUMWagOnrgr6ZCEUva9lttCSLKaqNDWkK__9B4Ev1ezdaWHrnI4Yk3X0WOAiM22Oo4zD3_3veK8Y3JjA0U_TVY1DINT2MJ3J7XjZtjf68mLMADorgWJzIaDuQ0MCoa-n](https://lh7-us.googleusercontent.com/6d3sWP48n91qiUMWagOnrgr6ZCEUva9lttCSLKaqNDWkK__9B4Ev1ezdaWHrnI4Yk3X0WOAiM22Oo4zD3_3veK8Y3JjA0U_TVY1DINT2MJ3J7XjZtjf68mLMADorgWJzIaDuQ0MCoa-n)

1 số endpoint hoạt động, /access khá interesting

![https://lh7-us.googleusercontent.com/g8ZSNUT9pvWuCMGQSFbZInvikg-kcJS72hF3ZYW7yVV-TpUthRrdVnK4GpLc-1Sl-e4Za94JRmxKo9pkfJbeDKXJGUPdoGv_gxb-UzWaynD_0g3Jf2j1VUX4GfUu__TuiZElkO2swJ1w](https://lh7-us.googleusercontent.com/g8ZSNUT9pvWuCMGQSFbZInvikg-kcJS72hF3ZYW7yVV-TpUthRrdVnK4GpLc-1Sl-e4Za94JRmxKo9pkfJbeDKXJGUPdoGv_gxb-UzWaynD_0g3Jf2j1VUX4GfUu__TuiZElkO2swJ1w)

có 2 chức năng

![https://lh7-us.googleusercontent.com/TPRB17HNjdt9h-KBbIbZJClg4BvObfdT1Fyo0ISf0DaLRkst0cqZ3vVcYaM19QMdHgjj93mJLCvl6dTQLAvox_hAAqVqqqeriAl6FM2o7MVXDXPjkAp7Advipa9gxmOay1n3YzRBwpv7](https://lh7-us.googleusercontent.com/TPRB17HNjdt9h-KBbIbZJClg4BvObfdT1Fyo0ISf0DaLRkst0cqZ3vVcYaM19QMdHgjj93mJLCvl6dTQLAvox_hAAqVqqqeriAl6FM2o7MVXDXPjkAp7Advipa9gxmOay1n3YzRBwpv7)

cho phép Download và Regenerate their VPN file để truy cập cơ sở hạ tầng HTB.

sử dụng  BurpSuite xem Connection Pack download button làm cái gì:

GET  /api/v1/users/vpn/generate và trả về file vpn của user hiện tại

![https://lh7-us.googleusercontent.com/wLAAJU_O0R6ZvSW0zi6l5FT_gls0iSTWHuZeckTZQI1H3Rq3uyx9d_NRrWqM5YfsMToE7kwTATBAVZ7sOoVK2xaGDdoX1jxkylK2plJ0X0uCIkMgyop1m6Duq-UwFFlFZgX6631HiDwg](https://lh7-us.googleusercontent.com/wLAAJU_O0R6ZvSW0zi6l5FT_gls0iSTWHuZeckTZQI1H3Rq3uyx9d_NRrWqM5YfsMToE7kwTATBAVZ7sOoVK2xaGDdoX1jxkylK2plJ0X0uCIkMgyop1m6Duq-UwFFlFZgX6631HiDwg)

nd file

![https://lh7-us.googleusercontent.com/oSwOPeTBPuzRZWKEcDvJI0aajJh7oLzuAQkFOsGqjAcg3JSqlCyAscaR9LSmcgzreQQ6dEzA6g3xk45-Sb_Odjyhn93LZcExbjOjzGopC6Bj4x9RiRuldCps6MUnIBGHue_vzDlaW3KE](https://lh7-us.googleusercontent.com/oSwOPeTBPuzRZWKEcDvJI0aajJh7oLzuAQkFOsGqjAcg3JSqlCyAscaR9LSmcgzreQQ6dEzA6g3xk45-Sb_Odjyhn93LZcExbjOjzGopC6Bj4x9RiRuldCps6MUnIBGHue_vzDlaW3KE)

thử truy cập /api/v1 xem có gì -> lộ các endpoint dưới quyền admin

![https://lh7-us.googleusercontent.com/G_vBZ0hCw5fL1Fjtqv9ZMVjXuDZD38FaVpkTVQTrLAesTcWC79kN1rDrJhTeVhgjvuiMhGcNiDOladOWE7EnXHiVs8r5m9yQ02KJ9uFyhCL8IUNYlROqQDz7knTX93lPhFhwowX5dbqb](https://lh7-us.googleusercontent.com/G_vBZ0hCw5fL1Fjtqv9ZMVjXuDZD38FaVpkTVQTrLAesTcWC79kN1rDrJhTeVhgjvuiMhGcNiDOladOWE7EnXHiVs8r5m9yQ02KJ9uFyhCL8IUNYlROqQDz7knTX93lPhFhwowX5dbqb)

thử check endpoint là admin hay ko -> 200 ok nhưng kp admin

![https://lh7-us.googleusercontent.com/t31Sw6mdvArqX8Juj2dzNmsFiTmhdJPKB8a9MaKZAfSPp6BHgxfSs1VvqIrvVNZVsF_MQFt1dAtzqvlmbudSYictyo_H-3Ni5-gIIOBHKl_vMfXP-hI4G5hN5JFPDsDlNz50835Hadmh](https://lh7-us.googleusercontent.com/t31Sw6mdvArqX8Juj2dzNmsFiTmhdJPKB8a9MaKZAfSPp6BHgxfSs1VvqIrvVNZVsF_MQFt1dAtzqvlmbudSYictyo_H-3Ni5-gIIOBHKl_vMfXP-hI4G5hN5JFPDsDlNz50835Hadmh)

thử endpoint tạo vpn cho 1 user cụ thể -> 401 ko đc phép

![https://lh7-us.googleusercontent.com/nrae6OnARF7bom6k9yHonZlForPCpNB2o9wUz-jwSeTFF9c1766iObrDvj2PX1hyX0aVCEVmzGFeGLzNS0I5r82cIQKbVjSR8j1_BZY5FdFT0BJP2egHTUvLQX08hPAxVk_5sjfOdT9E](https://lh7-us.googleusercontent.com/nrae6OnARF7bom6k9yHonZlForPCpNB2o9wUz-jwSeTFF9c1766iObrDvj2PX1hyX0aVCEVmzGFeGLzNS0I5r82cIQKbVjSR8j1_BZY5FdFT0BJP2egHTUvLQX08hPAxVk_5sjfOdT9E)

thử endpoint cuối: update user settings ->200ok nhưng sai content type

đoạn này thử rce xem ntn? có xuất hiện www-data ko -> tạo reverse shell ko đc

vì trên thấy code data dạng json -> đổi sang json

![https://lh7-us.googleusercontent.com/oAqI7saphuzMTa4Q4N5LKdG5sQ9qamhjKNFfHwsohwLWPo12aIjhEPuyhTH7EKN944Wl2slkqbOENVYVf7XoL4AzKm7nSjmCj9U4RQev2dDzKpZbwPnVEtbZFX-KW9o9uoN8vQLtiKfb](https://lh7-us.googleusercontent.com/oAqI7saphuzMTa4Q4N5LKdG5sQ9qamhjKNFfHwsohwLWPo12aIjhEPuyhTH7EKN944Wl2slkqbOENVYVf7XoL4AzKm7nSjmCj9U4RQev2dDzKpZbwPnVEtbZFX-KW9o9uoN8vQLtiKfb)

thiếu mail

![https://lh7-us.googleusercontent.com/hKQGjjNUtTNf5p280zZYiH8jSwasjRA5uLstJnrq1y__m6bVpAAmxcBXED2xhV657dKqji81F5HhCwENse5hHTYLNJ7s7l6AHSvgipmZYANas8RxNkdkWHq86gpbmFqrscpfpww1-Ye9](https://lh7-us.googleusercontent.com/hKQGjjNUtTNf5p280zZYiH8jSwasjRA5uLstJnrq1y__m6bVpAAmxcBXED2xhV657dKqji81F5HhCwENse5hHTYLNJ7s7l6AHSvgipmZYANas8RxNkdkWHq86gpbmFqrscpfpww1-Ye9)

thêm mail vừa nãy đky tài khoản

thiếu xđ admin

![https://lh7-us.googleusercontent.com/qX9InTBbVpGpQOUEZzjS7hlnnPvMYPshVEKXYqCNqpkbSQjP3vWWMMpSyMu3fAvAOZ0qR_SzK77X-Jqvv2cWHzoeV0-j79DkGBNIISaJZL4iyquPaOlVCjBhG8KHo_q-CstUpkUQojWZ](https://lh7-us.googleusercontent.com/qX9InTBbVpGpQOUEZzjS7hlnnPvMYPshVEKXYqCNqpkbSQjP3vWWMMpSyMu3fAvAOZ0qR_SzK77X-Jqvv2cWHzoeV0-j79DkGBNIISaJZL4iyquPaOlVCjBhG8KHo_q-CstUpkUQojWZ)

thêm xđ admin nhưng cho giá trị 1 để update user mình vừa đk sẽ là admin -> có thông tin

![https://lh7-us.googleusercontent.com/YXw1S3lfy_Q96sTrPDRYHcvDkOxmUQc3klgfrH_DwooPwng0Xl8BUEjJsPgqyZxF-iW-ddsfechXCLP69enO5FPVRleX2kpRIE1wAkwxTarQcmpRL1ZnNBnIBIBEx0kXSYSxZJkdMltv](https://lh7-us.googleusercontent.com/YXw1S3lfy_Q96sTrPDRYHcvDkOxmUQc3klgfrH_DwooPwng0Xl8BUEjJsPgqyZxF-iW-ddsfechXCLP69enO5FPVRleX2kpRIE1wAkwxTarQcmpRL1ZnNBnIBIBEx0kXSYSxZJkdMltv)

xđ lại admin -> đã là admin

![https://lh7-us.googleusercontent.com/yBK4AExBW6goPDL4_18i1tybKMWKg6Q-WyIS-bcPCpqKgUkxo3SWlkdkJS2tZRLwtn7J10oNEy275YiwAsO-Z2UpPvnWKAf7HbbL5YDqlMi5sHhGWDjDPio6c7-Daj7ItIZudHTEwZwK](https://lh7-us.googleusercontent.com/yBK4AExBW6goPDL4_18i1tybKMWKg6Q-WyIS-bcPCpqKgUkxo3SWlkdkJS2tZRLwtn7J10oNEy275YiwAsO-Z2UpPvnWKAf7HbbL5YDqlMi5sHhGWDjDPio6c7-Daj7ItIZudHTEwZwK)

nếu vpn được tạo bằng hàm exec hoặc system của php mà ko lọc cẩn thận -> rce

![https://lh7-us.googleusercontent.com/_eHzt3l-TiVIT3ohmst0rpm4xaepo-BlZjPsMFIkJuhLW0-bwGgJV8zttk2ICqTVco7pSP9dXnXAIcBWQQAECpSQ6Ub5xQ0tpDoHWVthTi4CalgM5TVTPqzb5cqp5iX7Dh6rrumMH88r](https://lh7-us.googleusercontent.com/_eHzt3l-TiVIT3ohmst0rpm4xaepo-BlZjPsMFIkJuhLW0-bwGgJV8zttk2ICqTVco7pSP9dXnXAIcBWQQAECpSQ6Ub5xQ0tpDoHWVthTi4CalgM5TVTPqzb5cqp5iX7Dh6rrumMH88r)

![https://lh7-us.googleusercontent.com/AU7zwhbXuIfM9JaoWBt-e51gao-VJ6nNA6rYo9LUaKyQGkUBKNilMQ32cBeaBBzWYEc4WUTUNqFabeMbZeiEPJV2a3PnfrDlmlmvHLa0cVccrgtU-F2YM7pDuCAg4qLixPFBQYeOzt2M](https://lh7-us.googleusercontent.com/AU7zwhbXuIfM9JaoWBt-e51gao-VJ6nNA6rYo9LUaKyQGkUBKNilMQ32cBeaBBzWYEc4WUTUNqFabeMbZeiEPJV2a3PnfrDlmlmvHLa0cVccrgtU-F2YM7pDuCAg4qLixPFBQYeOzt2M)

tạo reverse shell

![https://lh7-us.googleusercontent.com/3HnGdQUE0D99Uwoo7BRmKSfaA_MMpFRpYGvzD_9fvqgFJ8PmpCT9Osg4CB8VWdVhtlbOwkWnQ74EthJcdzxPDFr6XBbtFcily5hamcjxptqdqVHxFzj7kxC-C4wTllA_5jDqkSgNdoiz](https://lh7-us.googleusercontent.com/3HnGdQUE0D99Uwoo7BRmKSfaA_MMpFRpYGvzD_9fvqgFJ8PmpCT9Osg4CB8VWdVhtlbOwkWnQ74EthJcdzxPDFr6XBbtFcily5hamcjxptqdqVHxFzj7kxC-C4wTllA_5jDqkSgNdoiz)

![https://lh7-us.googleusercontent.com/lE2iDJZf99xG-LtoNYKahXwDvj2KW3tpLvAxt9dMZWz7hKMjH1-QVnRKguZnoWXsA8wL54k51wVddU2FP35s7CnnX_HIzNaVDl-3DgAv2Ulk6Db9LC6kpAbtRv2GvMn0iZhD4tVBpYo0](https://lh7-us.googleusercontent.com/lE2iDJZf99xG-LtoNYKahXwDvj2KW3tpLvAxt9dMZWz7hKMjH1-QVnRKguZnoWXsA8wL54k51wVddU2FP35s7CnnX_HIzNaVDl-3DgAv2Ulk6Db9LC6kpAbtRv2GvMn0iZhD4tVBpYo0)

![https://lh7-us.googleusercontent.com/-nmIYEYMPchCRVxDaaRRzNt-VAqNvoVyPAb01XTR67tw6XfP3F7OFh6R0gMi8HfGOs4Hie8CHAkPyEJedfnZJDzmmfN4HizYyNEChvJJlb-JR5Wdz7UxQRsGYDRMqtiIGC2ntNQNi3Jy](https://lh7-us.googleusercontent.com/-nmIYEYMPchCRVxDaaRRzNt-VAqNvoVyPAb01XTR67tw6XfP3F7OFh6R0gMi8HfGOs4Hie8CHAkPyEJedfnZJDzmmfN4HizYyNEChvJJlb-JR5Wdz7UxQRsGYDRMqtiIGC2ntNQNi3Jy)

có được shell dưới quyền www-data

nhưng ko có quyền đọc user.txt

![https://lh7-us.googleusercontent.com/nAbc67zPMj1s49TPFxH15NZj9K8u-KvwMoiOatTlNXbIxy70Uk4euklhxywgf1DyPEbW-P6b3FOr-RC8De3ZJPfxNn-GoUHGurITLDl10glHmWgp42ebKWj2ypc3Hl8m4GDoWe2-8DXl](https://lh7-us.googleusercontent.com/nAbc67zPMj1s49TPFxH15NZj9K8u-KvwMoiOatTlNXbIxy70Uk4euklhxywgf1DyPEbW-P6b3FOr-RC8De3ZJPfxNn-GoUHGurITLDl10glHmWgp42ebKWj2ypc3Hl8m4GDoWe2-8DXl)

tìm kiếm thấy .env có chứa thông tin xác thực của user admin

![https://lh7-us.googleusercontent.com/rDAbTw14hIEezGp_bM_wc4aHAE1evwsKWDRT6qLe963xK7LcZsdpbyhuCICKd1-3AlhGYL8JMWBB2YMV2gEe8gh_IqHxD6D4d0Mgls8_4b4ThCm2md_gjtRNa-tSY_IHq81R8PuKnRrr](https://lh7-us.googleusercontent.com/rDAbTw14hIEezGp_bM_wc4aHAE1evwsKWDRT6qLe963xK7LcZsdpbyhuCICKd1-3AlhGYL8JMWBB2YMV2gEe8gh_IqHxD6D4d0Mgls8_4b4ThCm2md_gjtRNa-tSY_IHq81R8PuKnRrr)

kiểm tra -> đúng là có user admin

![https://lh7-us.googleusercontent.com/emgT8ixsr15gJHzIdXkm64XssgkZ-Mytr6Mgk8GYcWIuokqitWReJ7sotnmVmQdRmLlPrRbmAXtepAM9QPXZxaQgtA-mnlJMxVkkwMw6iFRoCHgc_8gvrqJKUVdYAwp-ZcOH0WCrN5uK](https://lh7-us.googleusercontent.com/emgT8ixsr15gJHzIdXkm64XssgkZ-Mytr6Mgk8GYcWIuokqitWReJ7sotnmVmQdRmLlPrRbmAXtepAM9QPXZxaQgtA-mnlJMxVkkwMw6iFRoCHgc_8gvrqJKUVdYAwp-ZcOH0WCrN5uK)

vào tài khoản user admin -> đọc user.txt

![https://lh7-us.googleusercontent.com/Zu_wTcotMhEvJIwCNgWzR-VhEJODcgzi5RaBBbHJYB5VRzJ3Y7EVuj40BtqFmJsFSrwCR87HG3leTCqnbvPMSzmq2PTBx1LPXwqmTXj4Zgsfw1imFRLhsxG2fma0VIIL9_Khu9LQAqDO](https://lh7-us.googleusercontent.com/Zu_wTcotMhEvJIwCNgWzR-VhEJODcgzi5RaBBbHJYB5VRzJ3Y7EVuj40BtqFmJsFSrwCR87HG3leTCqnbvPMSzmq2PTBx1LPXwqmTXj4Zgsfw1imFRLhsxG2fma0VIIL9_Khu9LQAqDO)

tìm thấy mail của user admin

có cve trong kernel

![https://lh7-us.googleusercontent.com/mC-ZQYpiDegbzvwE0pej5-TVf0iWXInINXeokFwfchzbyo-lZnegb77aXdG0BFopFy3pSLeYlAomSw-2hLcg4Dkg9BQ-u2GhI9SQpU3hTIlYjfTWYeepeo2O4B4ETOLGE0cJ50h-W4v-](https://lh7-us.googleusercontent.com/mC-ZQYpiDegbzvwE0pej5-TVf0iWXInINXeokFwfchzbyo-lZnegb77aXdG0BFopFy3pSLeYlAomSw-2hLcg4Dkg9BQ-u2GhI9SQpU3hTIlYjfTWYeepeo2O4B4ETOLGE0cJ50h-W4v-)

[The OverlayFS vulnerability CVE-2023-0386: Overview, detection, and remediation | Datadog Security Labs (datadoghq.com)](https://securitylabs.datadoghq.com/articles/overlayfs-cve-2023-0386/)

tải exploit và đưa sang shell victim

[CVE-2023-0386/README.md at main · xkaneiki/CVE-2023-0386 (github.com)](https://github.com/xkaneiki/CVE-2023-0386/blob/main/README.md)

ngoài sử dụng scp có thể tạo server và dùng wget để tải file xuống (nếu ko được quyền thì vào /tmp luôn được cấp quyền any)

![https://lh7-us.googleusercontent.com/exBoFypcb-4YihXsRUVg74l8VoAiJniiYn5btOZWYDQkAI8c0NmEfMYLHIuNbSRG02IRYPUOvkbwHfAv47XJfG856Q6d7_IB_HC2upKeezJuKwako0cGEM8f98is_T020n2vP5hz8kyq](https://lh7-us.googleusercontent.com/exBoFypcb-4YihXsRUVg74l8VoAiJniiYn5btOZWYDQkAI8c0NmEfMYLHIuNbSRG02IRYPUOvkbwHfAv47XJfG856Q6d7_IB_HC2upKeezJuKwako0cGEM8f98is_T020n2vP5hz8kyq)

![https://lh7-us.googleusercontent.com/I_PtHkgHA3oozfr9AWBtwu4W8yU6-43bzINK0GtAKflKQlUUJF8mf-Y2mRtFOoiFFdmb5Hyd9n6wXUudhCQ02KrtS7yYGu6v7UtsQAVETFIz7ndwnXpRDGtUsTdJxb7o1otvziBFIbTL](https://lh7-us.googleusercontent.com/I_PtHkgHA3oozfr9AWBtwu4W8yU6-43bzINK0GtAKflKQlUUJF8mf-Y2mRtFOoiFFdmb5Hyd9n6wXUudhCQ02KrtS7yYGu6v7UtsQAVETFIz7ndwnXpRDGtUsTdJxb7o1otvziBFIbTL)

hd thực thi

![https://lh7-us.googleusercontent.com/fGMbJpk8zNDBh2nN4yBJdxq0QlFZotIOUP1TbHg81lpHNPiGlkIqTsBc8Y9Do4A-Zj85-qrh7z6Z213we1f8bKRdb7_8KSVvq5GS9ZMF98xkwgQIrO-c7IQ1dZpfnlZdAhBbGTYMFs5g](https://lh7-us.googleusercontent.com/fGMbJpk8zNDBh2nN4yBJdxq0QlFZotIOUP1TbHg81lpHNPiGlkIqTsBc8Y9Do4A-Zj85-qrh7z6Z213we1f8bKRdb7_8KSVvq5GS9ZMF98xkwgQIrO-c7IQ1dZpfnlZdAhBbGTYMFs5g)

![https://lh7-us.googleusercontent.com/fT8jRfzTWTd1W_z_kQlaHyCdly3p9C-P1jVglNEVp2_R1cJmZitAy1krGr0EvfDGBFukpNrFnjs-nSJbT0XcMWuK1doWJ28cO4DSetnGQOhkMAXDnUdHwYxtbWGsJMP73_95iOSjQOIy](https://lh7-us.googleusercontent.com/fT8jRfzTWTd1W_z_kQlaHyCdly3p9C-P1jVglNEVp2_R1cJmZitAy1krGr0EvfDGBFukpNrFnjs-nSJbT0XcMWuK1doWJ28cO4DSetnGQOhkMAXDnUdHwYxtbWGsJMP73_95iOSjQOIy)

![https://lh7-us.googleusercontent.com/wfyPacQFDLIh0g-gpCRS-OYowgl4CP60HqVjLxzBKToUrys-opzo_mRh2X9n_7Z7bl33Ejd6V5QPKn5683OZ9-8xBTn1bUP9DIoLqrNDZbm3T2ooOFRk9wuyTzQ1Mn7uwH7l-rtxokWy](https://lh7-us.googleusercontent.com/wfyPacQFDLIh0g-gpCRS-OYowgl4CP60HqVjLxzBKToUrys-opzo_mRh2X9n_7Z7bl33Ejd6V5QPKn5683OZ9-8xBTn1bUP9DIoLqrNDZbm3T2ooOFRk9wuyTzQ1Mn7uwH7l-rtxokWy)