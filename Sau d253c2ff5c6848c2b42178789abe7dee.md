# Sau

server chạy nhiều dịch vụ, trong đó p22 và 55555 thì bên ngoài có thể truy cập và nmap, còn p80 thì ko, nó chỉ tương tác được với localhost, nhưng nó lại có thể tương tác ra ngoài (đoạn netcat có được shell puma). từ p55555 có lỗ hổng ssrf, lợi dụng để truy cập đến p80

![https://lh7-us.googleusercontent.com/LA4vLZ7vwjT6oKE1s2Q_QVFXkvdM7orn1AMYHkugLk5MzPZ6WVeLe923vTEZedhoMt7iFONr0dQRqZuCO_D2pIRn7UxiCa45-nduZ6gz997QMbtvrCZK17kWK5y9FIWZWXcCDZHl2zP-](https://lh7-us.googleusercontent.com/LA4vLZ7vwjT6oKE1s2Q_QVFXkvdM7orn1AMYHkugLk5MzPZ6WVeLe923vTEZedhoMt7iFONr0dQRqZuCO_D2pIRn7UxiCa45-nduZ6gz997QMbtvrCZK17kWK5y9FIWZWXcCDZHl2zP-)

nmap thấy p 22 và 55555

![https://lh7-us.googleusercontent.com/O1exnXPr9O7NzMLbMq1O_SHXRgzCD2h5rCoGbPNBMYxZQLMjLsR45BnV2TnDFJtY6Yb-JrXtZ4hqsQ5A0azY_CohhcW1_uZQ9Yiqlpz_ff-j-S_0G7THBtHZEl-hr-dEEtg7NcK5N5lk](https://lh7-us.googleusercontent.com/O1exnXPr9O7NzMLbMq1O_SHXRgzCD2h5rCoGbPNBMYxZQLMjLsR45BnV2TnDFJtY6Yb-JrXtZ4hqsQ5A0azY_CohhcW1_uZQ9Yiqlpz_ff-j-S_0G7THBtHZEl-hr-dEEtg7NcK5N5lk)

lần này quét có 80 nhưng ko mở đc

![https://lh7-us.googleusercontent.com/MunRXDawJyJPFyACOAt5wzpuUFY4QikW9Bq-36wpViE22ohIwoDA7raxVfAbj64g_2f0FmDnzQ3pQYob8CqtEwPLMAqTZ1fIlQ4rjc7vJ2i626G0exs3oH6QZ9d10Q3OHCbJdxt3iSIu](https://lh7-us.googleusercontent.com/MunRXDawJyJPFyACOAt5wzpuUFY4QikW9Bq-36wpViE22ohIwoDA7raxVfAbj64g_2f0FmDnzQ3pQYob8CqtEwPLMAqTZ1fIlQ4rjc7vJ2i626G0exs3oH6QZ9d10Q3OHCbJdxt3iSIu)

mở thử 10.10.11.224:55555 thấy web, chú ý tên và version của web -> PoC ssrf

![https://lh7-us.googleusercontent.com/hEJgP2B8ndrq9cAlsrrrPCBEGjy9R48h_dFKXXMLCd0YzbwW4YkdlXuSPykXDoirCHxrhzyRcLmCJG25nU3_cc2gFUCUUmvXDjAYL3-PI1ksJN72wFRzWlnwrnzYIa3m9GjXvPgksqpu](https://lh7-us.googleusercontent.com/hEJgP2B8ndrq9cAlsrrrPCBEGjy9R48h_dFKXXMLCd0YzbwW4YkdlXuSPykXDoirCHxrhzyRcLmCJG25nU3_cc2gFUCUUmvXDjAYL3-PI1ksJN72wFRzWlnwrnzYIa3m9GjXvPgksqpu)

![https://lh7-us.googleusercontent.com/lyWvvZT1qEvwQ3jVdM2P2RptRp9FF23O5w7tgj5BLxxiHpWoD_MIT3PIdiDuNyBVnuYP747I0uhypjcg_GvZWelB3H-sHQGcqC7CrktSddHAAdh4GB0Dju_Y2C0Qxt7biQTTkUXG1XJL](https://lh7-us.googleusercontent.com/lyWvvZT1qEvwQ3jVdM2P2RptRp9FF23O5w7tgj5BLxxiHpWoD_MIT3PIdiDuNyBVnuYP747I0uhypjcg_GvZWelB3H-sHQGcqC7CrktSddHAAdh4GB0Dju_Y2C0Qxt7biQTTkUXG1XJL)

![https://lh7-us.googleusercontent.com/p1JJrQPUf1OMoYKh3JAKv24VcjcAkOkf3Sj1ftT71vXjzmIUCcAmtNDurxZcBsFziuxn3XDAtIp_gTG_td02l86aq5xJrjZt6WthDpxo91GGwhFQ-IEWjZePdsTYoIBUA-330g1rwoed](https://lh7-us.googleusercontent.com/p1JJrQPUf1OMoYKh3JAKv24VcjcAkOkf3Sj1ftT71vXjzmIUCcAmtNDurxZcBsFziuxn3XDAtIp_gTG_td02l86aq5xJrjZt6WthDpxo91GGwhFQ-IEWjZePdsTYoIBUA-330g1rwoed)

![https://lh7-us.googleusercontent.com/l2vByPNvrsdCSygQcl1u4RV4rysL2fjGAb79dr87lMg2GSc3xjSIpLcdVHRn-Z2lAI-CoYJXNdFn-3-r_G94Bch1eQPFO5UYIvcZiR54Uhe9pN24_X6-Mv-iHe6v6GUVgAn30hJgyrTA](https://lh7-us.googleusercontent.com/l2vByPNvrsdCSygQcl1u4RV4rysL2fjGAb79dr87lMg2GSc3xjSIpLcdVHRn-Z2lAI-CoYJXNdFn-3-r_G94Bch1eQPFO5UYIvcZiR54Uhe9pN24_X6-Mv-iHe6v6GUVgAn30hJgyrTA)

phản hồi có url có thể truy cập

![https://lh7-us.googleusercontent.com/-z9nUjDBgWLVETaBHxisLKecQin7iHN0eEqfejxhq2GuodG-uTsSITrZFT-B121yf2vn3-5iCMZ7hdOezW_S6wTdl9tCvZvUQenQme3K2O_Qin-E_lBFsrmTCJpAyQg8kZBmlpJCOZ4E](https://lh7-us.googleusercontent.com/-z9nUjDBgWLVETaBHxisLKecQin7iHN0eEqfejxhq2GuodG-uTsSITrZFT-B121yf2vn3-5iCMZ7hdOezW_S6wTdl9tCvZvUQenQme3K2O_Qin-E_lBFsrmTCJpAyQg8kZBmlpJCOZ4E)

có được truy cập vào p80 localhost , chú ý tên và version -> unauthenticated OS command injection

![https://lh7-us.googleusercontent.com/QQUQYEZU-n7VpGCXcihOssbNtYN8fpRKqCaavt6C9hxOq9IvvjwsjSlohztq9eaPT8HYRPpQSp6yMMWkLK7YCZ_i0wEORyYPfKPbZUfZFGyG5rr8fIoXX8HC3p74MVy5awt_SEa9XqDE](https://lh7-us.googleusercontent.com/QQUQYEZU-n7VpGCXcihOssbNtYN8fpRKqCaavt6C9hxOq9IvvjwsjSlohztq9eaPT8HYRPpQSp6yMMWkLK7YCZ_i0wEORyYPfKPbZUfZFGyG5rr8fIoXX8HC3p74MVy5awt_SEa9XqDE)

![https://lh7-us.googleusercontent.com/2nZnWjUABWJ0Xz1qHPz9PLRMyn4DteUjIQA9yPF775EJdGglgNEbcDy49kmDLBubJVwuHPIVlDc6fBvGoIFW9ZldQpvhc1LAclHQCcMw5ZB0G2JP7bvFt2cWphXSyV1PnWfPZ7oImOi-](https://lh7-us.googleusercontent.com/2nZnWjUABWJ0Xz1qHPz9PLRMyn4DteUjIQA9yPF775EJdGglgNEbcDy49kmDLBubJVwuHPIVlDc6fBvGoIFW9ZldQpvhc1LAclHQCcMw5ZB0G2JP7bvFt2cWphXSyV1PnWfPZ7oImOi-)

The login page doesn’t sanitize the input for the username parameter, which leads to OS command injection.

![https://lh7-us.googleusercontent.com/t2A3ldw9Iu2eh97BCmZSADyCc3gEjfzULJ589xSkvZUgK3DmZ9tOV4q2LkTrQCJuFpsEnjNcKfIAUyztgaTXXKHEBV2MRJkGsjrleW533xGhhNr94shY9I4LpUhO97AljDWMN2VGWCV1](https://lh7-us.googleusercontent.com/t2A3ldw9Iu2eh97BCmZSADyCc3gEjfzULJ589xSkvZUgK3DmZ9tOV4q2LkTrQCJuFpsEnjNcKfIAUyztgaTXXKHEBV2MRJkGsjrleW533xGhhNr94shY9I4LpUhO97AljDWMN2VGWCV1)

![https://lh7-us.googleusercontent.com/5P2eC9sZGERA4XI44WX2PdMaI5rep5zkySfqUAe7wmLPk7-yR_BIr9pc41lN1EUNj8BWWRHvYf5A4E6zfJ3tJSzq9loesn6-J2upR2TfgKoLhP3mpKQ8bvOXAD3UXF4qLW_RhlI7AUZN](https://lh7-us.googleusercontent.com/5P2eC9sZGERA4XI44WX2PdMaI5rep5zkySfqUAe7wmLPk7-yR_BIr9pc41lN1EUNj8BWWRHvYf5A4E6zfJ3tJSzq9loesn6-J2upR2TfgKoLhP3mpKQ8bvOXAD3UXF4qLW_RhlI7AUZN)

![https://lh7-us.googleusercontent.com/IQ5lek7NG5iuPpbEa9Ct_-JX4FRfDFNyIJMAlTEjWWUAxC653HIBMI4yN9QGpMLjTYeo1bUQWAVehWCvri_LYLR7_T8hexhlf-l4APTtGrG5ViMK5jyjT4EK4yySYF4X9oDhmK_V2aDR](https://lh7-us.googleusercontent.com/IQ5lek7NG5iuPpbEa9Ct_-JX4FRfDFNyIJMAlTEjWWUAxC653HIBMI4yN9QGpMLjTYeo1bUQWAVehWCvri_LYLR7_T8hexhlf-l4APTtGrG5ViMK5jyjT4EK4yySYF4X9oDhmK_V2aDR)

![https://lh7-us.googleusercontent.com/BDRlXcrTrx8Tk4DUFM9JzCedcTqfPnDL24dRRb7zsMGHP4XZAk4ETNeZN87fRcPi0gi1F18TxwF-Yed18BshAGCTY_ROukIZrpNVk3ZHOU0j7pLX4TipFXRy39UXUrEt-UasSvDMBoBm](https://lh7-us.googleusercontent.com/BDRlXcrTrx8Tk4DUFM9JzCedcTqfPnDL24dRRb7zsMGHP4XZAk4ETNeZN87fRcPi0gi1F18TxwF-Yed18BshAGCTY_ROukIZrpNVk3ZHOU0j7pLX4TipFXRy39UXUrEt-UasSvDMBoBm)

![https://lh7-us.googleusercontent.com/gkRWZlAfz_wLNYB9ZkgpOLJTqqmJ1k-Ev28WgeX5YKTPOxBqiFFoxtL-vgH-gMUQum-qnbL2g_dP4Ybe2OgUtMX5xiX4KYGl7CpagGXJawQoclumDwFfc-3wkkF_-bGV5xFh8Kq3mdcO](https://lh7-us.googleusercontent.com/gkRWZlAfz_wLNYB9ZkgpOLJTqqmJ1k-Ev28WgeX5YKTPOxBqiFFoxtL-vgH-gMUQum-qnbL2g_dP4Ybe2OgUtMX5xiX4KYGl7CpagGXJawQoclumDwFfc-3wkkF_-bGV5xFh8Kq3mdcO)

có được shell của puma

![https://lh7-us.googleusercontent.com/sxGXlYTt9BHxA3YhLar6OlKmInunp-ZvZ1AcXdV_9h3Mj61G3k1zw9XrfoSUh83lHZCgWACJ0pFvMO1pC2Xq1wh6WrK32RF-8g_HQHdazlEEusy1z03xASOfepNUIwxPmOrWc_ObonHr](https://lh7-us.googleusercontent.com/sxGXlYTt9BHxA3YhLar6OlKmInunp-ZvZ1AcXdV_9h3Mj61G3k1zw9XrfoSUh83lHZCgWACJ0pFvMO1pC2Xq1wh6WrK32RF-8g_HQHdazlEEusy1z03xASOfepNUIwxPmOrWc_ObonHr)

![https://lh7-us.googleusercontent.com/DvbFT6S8NEtVHhXTLSziEHxb12vhLMTCPm-SLXxjUKSViuma_ktJLp_a49t7cI28039sfZoOF-AbDXXgBAg0MnZUsUJ2YwymtWc-SD8bjrJhWACCcf5ZRmoAR9djFC3FV-gGm4NORTLp](https://lh7-us.googleusercontent.com/DvbFT6S8NEtVHhXTLSziEHxb12vhLMTCPm-SLXxjUKSViuma_ktJLp_a49t7cI28039sfZoOF-AbDXXgBAg0MnZUsUJ2YwymtWc-SD8bjrJhWACCcf5ZRmoAR9djFC3FV-gGm4NORTLp)

![https://lh7-us.googleusercontent.com/JdjZzbSXsFX5wtFGJeu_w4niteJq7ZEGGkaGzsPrgQ510XyxK61b8a0EyLxDjM-6K-40LGn5ynfE0KYvAbegn-zsfxRBlDiLlLfx3eERRIjqPD7vFL3sEQD1SIn2orcgDEpT0uKYmO8I](https://lh7-us.googleusercontent.com/JdjZzbSXsFX5wtFGJeu_w4niteJq7ZEGGkaGzsPrgQ510XyxK61b8a0EyLxDjM-6K-40LGn5ynfE0KYvAbegn-zsfxRBlDiLlLfx3eERRIjqPD7vFL3sEQD1SIn2orcgDEpT0uKYmO8I)

![https://lh7-us.googleusercontent.com/Ew8hFEyKhbJxTQa1Plk-2Jb3S5mBqboTGXQ6ETrRt5yp7IIy-EJJWLEWSTztjHOqJ58lVLhypxHcG9JPEQPduk-dULkgHxRHrrHKRzBmuRXUx5Na_xbi_JJ3Ld_di9p_flLN2iHzxq2B](https://lh7-us.googleusercontent.com/Ew8hFEyKhbJxTQa1Plk-2Jb3S5mBqboTGXQ6ETrRt5yp7IIy-EJJWLEWSTztjHOqJ58lVLhypxHcG9JPEQPduk-dULkgHxRHrrHKRzBmuRXUx5Na_xbi_JJ3Ld_di9p_flLN2iHzxq2B)

- > chạy bth ko ảnh hưởng, chỉ hiển thị trạng thái. nhưng khi sử dụng sudo thì khác

sử dụng !sh hoặc !bash để spawn a root shell

Có một tính năng tiện lợi ít giống với một số chương trình toàn màn hình khác cho phép người dùng chạy các lệnh shell từ bên trong nó bằng cách thêm dấu '!' vào trước lệnh. Ví dụ: !id

![https://lh7-us.googleusercontent.com/95rv552Ne1gp4L-EWx1eVUhrT-lR1cIvbmZmG0ORHcl1R5BxCOvZFZoZLbVY-EkzHwPZ6EstAHbh-5m8EnWCTGkDTVJBhpDnJR_T3Cr3Zo6se3pLMno0qQENHVZ0rrhtu5C8JqTEuQcI](https://lh7-us.googleusercontent.com/95rv552Ne1gp4L-EWx1eVUhrT-lR1cIvbmZmG0ORHcl1R5BxCOvZFZoZLbVY-EkzHwPZ6EstAHbh-5m8EnWCTGkDTVJBhpDnJR_T3Cr3Zo6se3pLMno0qQENHVZ0rrhtu5C8JqTEuQcI)